<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Работа с инструкциями и результирующими наборами</title><meta name="Language" content="ru-RU" /><meta name="System.Keywords" content="результирующий набор, эффективность" /><meta name="System.Keywords" content="инструкции, эффективность" /><meta name="Microsoft.Help.Id" content="cc917534-f5f8-4844-87c8-597c48b4e06d" /><meta name="Description" content="При работе с драйвером Драйвер Microsoft JDBC для SQL Server и его объектами Statement и ResultSet существует ряд методик, которые повышают производительность и надежность приложений." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Работа с инструкциями и результирующими наборами</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>При работе с драйвером Драйвер Microsoft JDBC для SQL Server и его объектами <b>Statement</b> и <b>ResultSet</b> существует ряд методик, которые повышают производительность и надежность приложений. </p></div><h1 class="heading">Использование подходящего объекта инструкции</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>При использовании одного из объектов драйвера JDBC <b>Statement</b>, например <a href="ec24963c-8b51-4838-91e9-1fbfa2347451.htm">SQLServerStatement</a>, <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> или <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a>, убедитесь, что объект подходит для решения задачи.</p><ul><li><p>Если параметры OUT отсутствуют, то использовать объект <b>SQLServerCallableStatement</b> не нужно. Вместо этого используйте объект <b>SQLServerStatement</b> или <b>SQLServerPreparedStatement</b>.</p></li><li><p>Если не планируется исполнять инструкции несколько раз или параметры IN либо OUT отсутствуют, то использовать объект <b>SQLServerCallableStatement</b> или <b>SQLServerPreparedStatement</b> не нужно. Вместо этого используйте объект <b>SQLServerStatement</b>.</p></li></ul></div><h1 class="heading">Используйте подходящий параллелизм для объектов ResultSet</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>Обновляемый параллелизм при создании инструкций, выдающих результирующие наборы, требуется, только если планируется непременно обновлять результаты. Маленькие результирующие наборы быстрее всего считывает стандартная однопроходная неизменяемая модель курсора.</p></div><h1 class="heading">Ограничение размера результирующих наборов</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>Возможно, следует использовать метод <a href="cccc0667-589b-4655-8ea8-14ae8b2eb9dc.htm">setMaxRows</a> (либо синтаксис SQL — SET ROWCOUNT или SELECT TOP N) для ограничения числа строк, возвращаемых из потенциально больших результирующих наборов. Если приходится работать с большими результирующими наборами, то, возможно, следует использовать адаптивную буферизацию ответов. Для этого нужно установить свойству строки соединения responseBuffering значение «adaptive». Это значение используется по умолчанию. Такая методика позволяет приложению обрабатывать большие результирующие наборы, не прибегая к курсорам на стороне сервера, и свести к минимуму занимаемую приложением память. Дополнительные сведения см. в разделе <span sdata="link"><a href="92d4e3be-c3e9-4732-9a60-b57f4d0f7cb7.htm">Использование адаптивной буферизации</a></span>.</p></div><h1 class="heading">Использование выборки подходящего размера</h1><div id="sectionSection3" class="section" name="collapseableSection" style=""><p>Для серверных курсоров только для чтения целесообразность определяется сравнением затрат на обращение к серверу и затрат памяти драйвером. Для обновляемых серверных курсоров размер выборки также влияет на чувствительность результирующего набора к изменениям и параллелизму на сервере. Обновления строк в текущем буфере выборки не будут видны, пока не будет выдан явный метод <a href="048fe245-157f-4fd8-be75-ce54b83e02b3.htm">refreshRow</a> или пока курсор не покинет буфер выборки. У больших буферов выборки будет лучшая производительность (меньше обращений к серверу), но у них меньше чувствительность к изменениям и уменьшению параллелизма на сервере при использовании CONCUR_SS_SCROLL_LOCKS (1009). Для максимальной чувствительности к изменениям размер выборки должен равняться 1. Однако при этом будет совершаться одно обращение к серверу на каждую выбранную строку.</p></div><h1 class="heading">Использование потоков для больших параметров IN</h1><div id="sectionSection4" class="section" name="collapseableSection" style=""><p>Используйте потоки объектов BLOB и CLOB, постепенно материализуемые для управления обновляющимися большими значениями столбцов или отправления больших параметров IN. Драйвер JDBC «дробит» их и отправляет на сервер за несколько обращений, тем самым позволяя задавать и обновлять значения большие, чем помещаются в памяти.</p></div><span id="seeAlsoSpan"><h1 class="heading">См. также</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="e1592499-b87b-45ee-bab8-beaba8fde841.htm">Повышение производительности и надежности с помощью драйвера JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Отправить <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dСпасибо%20за%20отзыв!%20Отзывы%20помогают%20команде%20разработчиков%20в%20улучшении%20документации.%20Просматривая%20ваши%20отзывы,%20корпорация%20Майкрософт%20может%20спросить%20по%20электронной%20почте%20ваше%20мнение,%20касающееся%20определенного%20решения.%20Адрес%20электронной%20почты%20не%20используется%20в%20других%20целях%20и%20удаляется%20корпорацией%20Майкрософт%20после%20завершения%20просмотра.%0\AДополнительные%20сведения%20о%20политике%20конфиденциальности%20корпорации%20Майкрософт%20см.%20на%20странице%20http://privacy.microsoft.com/ru-ru/default.aspx.%0\A%0\d','Отзывы%20пользователей.');">отзыв</a> об этом разделе в Майкрософт.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© © Корпорация Майкрософт (Microsoft Corporation), 2012 г. Все права защищены.</a></p></span></div></div></body></html>