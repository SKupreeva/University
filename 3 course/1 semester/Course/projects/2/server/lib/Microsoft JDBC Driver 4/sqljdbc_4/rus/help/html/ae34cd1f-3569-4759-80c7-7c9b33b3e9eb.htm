<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Настройка SSL-шифрования на клиенте</title><meta name="Language" content="ru-RU" /><meta name="System.Keywords" content="сертификат" /><meta name="System.Keywords" content="настройка сертификата SSL" /><meta name="System.Keywords" content="SSL" /><meta name="System.Keywords" content="SSL-сертификат" /><meta name="Microsoft.Help.Id" content="ae34cd1f-3569-4759-80c7-7c9b33b3e9eb" /><meta name="Description" content="Драйвер Microsoft JDBC для SQL Server или клиент должен проверить правильность сервера, а также убедиться, что его сертификат выдан центром сертификации, которому доверяет клиент." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Настройка SSL-шифрования на клиенте</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Драйвер Microsoft JDBC для SQL Server или клиент должен проверить правильность сервера, а также убедиться, что его сертификат выдан центром сертификации, которому доверяет клиент. Чтобы проверить сертификат сервера, необходимо при соединении предоставить данные о доверии. Кроме того, поставщик сертификата сервера должен быть центром сертификации, которому доверяет клиент.</p><p>В начале этого раздела описано, как задать материал доверия на клиентском компьютере. Далее в этом разделе приведено описание того, как импортировать сертификат сервера в хранилище доверия клиентского компьютера, если экземпляр сертификата SSL для SQL Server выдан закрытым центром сертификации.</p><p>Дополнительные сведения о проверке сертификата сервера см. в разделе «Проверка сертификата SSL сервера» в <span sdata="link"><a href="073f3b9e-8edd-4815-88ea-de0655d0325e.htm">Основные сведения о поддержке SSL</a></span>.</p></div><h1 class="heading">Настройка клиентского хранилища доверия</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>Для проверки сертификата сервера требуется, чтобы материал доверия был явно задан во время соединения с использованием свойства <span class="label">trustStore</span> и свойств соединения <span class="label">trustStorePassword</span> или задан неявно с использованием предусмотренного по умолчанию хранилища доверия базовой виртуальной машины Java (JVM). Дополнительные сведения о том, как задавать свойства <span class="label">trustStore</span> и <span class="label">trustStorePassword</span> в строке соединения, см. в разделе <span sdata="link"><a href="ec91fa8a-ab7e-4c1e-a05a-d7951ddf33b1.htm">Соединение с помощью SSL-шифрования</a></span>.</p><p>Если свойство <span class="label">trustStore</span> не задано или имеет значение NULL, то драйвер Драйвер Microsoft JDBC для SQL Server полагается на поставщик безопасности базовой JVM, то есть расширение защищенных сокетов Java (SunJSSE). Поставщик SunJSSE предоставляет предусмотренный по умолчанию диспетчер <b>TrustManager</b>, который используется для проверки сертификатов X.509, возвращенных SQL Server, по материалу доверия, предоставленному в хранилище доверия.</p><p>Диспетчер <b>TrustManager</b> предпринимает попытки найти предусмотренное по умолчанию свойство trustStore в следующем порядке поиска.</p><ul><li><p>Если системное свойство «javax.net.ssl.trustStore» определено, то диспетчер <b>TrustManager</b> пытается найти предусмотренный по умолчанию файл trustStore с именем файла, указанным этим системным свойством.</p></li><li><p>Если свойство системы «javax.net.ssl.trustStore» не указано и существует файл «&lt;java-home&gt;/lib/security/jssecacerts», то используется этот файл. </p></li><li><p>Если файл «&lt;java-home&gt;/lib/security/cacerts» существует, то используется именно он.</p></li></ul><p>Дополнительные сведения см. в документации интерфейса SUNX509 TrustManager на веб-сайте Sun Microsystems.</p><p>Среда выполнения Java позволяет задавать системные свойства trustStore и trustStorePassword следующим образом. </p><div class="sampleCode"><span codeLanguage="other"><pre>java -Djavax.net.ssl.trustStore=C:\MyCertificates\storeName
java -Djavax.net.ssl.trustStorePassword=storePassword</pre></span></div><p>В этом случае любое приложение, запущенное на данной виртуальной машине JVM, будет использовать данные параметры по умолчанию. Чтобы переопределить параметры по умолчанию в конкретном приложении, необходимо задать свойства соединения <span class="label">trustStore</span> и <span class="label">trustStorePassword</span> в строке соединения или в соответствующем методе задания класса <a href="097434fd-2b74-411c-a5ed-eba04481dde5.htm">SQLServerDataSource</a>.</p><p>Кроме того, можно настраивать и управлять предусмотренными по умолчанию файлами хранилища доверия, такими как «&lt;java-home&gt;/lib/security/jssecacerts» и «&lt;java-home&gt;/lib/security/cacerts». Для этого предназначена программа JAVA «keytool», которая устанавливается вместе со средой выполнения Java (JRE). Дополнительные сведения о программе «keytool» см. в документации по keytool на веб-сайте Sun Microsystems.</p><h1 class="heading">Импорт сертификата сервера в хранилище доверия</h1><div class="subsection"><p>Во время SSL-подтверждения сервер отправляет свой сертификат открытого ключа клиенту. Поставщик сертификата открытого ключа называется центром сертификации (ЦС). Клиент должен убедиться, что рассматриваемый центр сертификации является для клиента доверенным. Для этого заранее изучаются открытые ключи доверенных центров сертификации. JVM обычно поставляется со стандартным набором доверенных центров сертификации. </p><p>Если используемый экземпляр сертификата SSL для SQL Server выдан закрытым центром сертификации, то необходимо добавить этот сертификат центра сертификации к списку доверенных сертификатов в хранилище доверия клиентского компьютера.</p><p>Для этого используется программа JAVA «keytool», которая устанавливается со средой выполнения Java (JRE). В следующей командной строке показано, как использовать программу «keytool» для импорта сертификата из файла.</p><div class="sampleCode"><span codeLanguage="other"><pre>keytool -import -v -trustcacerts -alias myServer -file caCert.cer -keystore truststore.ks</pre></span></div><p>В этом примере в качестве файла сертификата используется файл «caCert.cer». Этот файл сертификата необходимо получить с сервера. Следующие шаги показывают, как экспортировать сертификат сервера в файл.</p><ol><li><p>Нажмите «Пуск», затем «Выполнить» и введите MMC. (MMC — сокращение от Microsoft Management Console, консоль управления Microsoft.)</p></li><li><p>В программе MMC откройте окно «Сертификаты». </p></li><li><p>Разверните элемент «Личный», затем «Сертификаты». </p></li><li><p>Щелкните правой кнопкой мыши сертификат сервера и выберите «Все задачи/Экспорт». </p></li><li><p>Нажмите кнопку «Далее», чтобы перейти к окну, которое следует за диалоговым окном приветствия мастера экспорта сертификатов. </p></li><li><p>Убедитесь, что выбрано значение «Нет, не экспортировать закрытый ключ», затем нажмите «Далее». </p></li><li><p>Выберите либо двоичное значение в DER-кодировке X.509 (.CER), либо в Base64-кодировке X.509 (.CER) и нажмите кнопку «Далее». </p></li><li><p>Введите имя файла для экспорта.</p></li><li><p>Нажмите кнопку «Далее», затем нажмите кнопку «Готово», чтобы экспортировать сертификат.</p></li></ol></div></div><span id="seeAlsoSpan"><h1 class="heading">См. также</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="8e566243-2f93-4b21-8065-3c8336649309.htm">Использование SSL-шифрования</a></span></div><div class="seeAlsoStyle"><span sdata="link"><a href="90724ec6-a9cb-43ef-903e-793f89410bc0.htm">Защита приложений драйвера JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Отправить <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dСпасибо%20за%20отзыв!%20Отзывы%20помогают%20команде%20разработчиков%20в%20улучшении%20документации.%20Просматривая%20ваши%20отзывы,%20корпорация%20Майкрософт%20может%20спросить%20по%20электронной%20почте%20ваше%20мнение,%20касающееся%20определенного%20решения.%20Адрес%20электронной%20почты%20не%20используется%20в%20других%20целях%20и%20удаляется%20корпорацией%20Майкрософт%20после%20завершения%20просмотра.%0\AДополнительные%20сведения%20о%20политике%20конфиденциальности%20корпорации%20Майкрософт%20см.%20на%20странице%20http://privacy.microsoft.com/ru-ru/default.aspx.%0\A%0\d','Отзывы%20пользователей.');">отзыв</a> об этом разделе в Майкрософт.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© © Корпорация Майкрософт (Microsoft Corporation), 2012 г. Все права защищены.</a></p></span></div></div></body></html>