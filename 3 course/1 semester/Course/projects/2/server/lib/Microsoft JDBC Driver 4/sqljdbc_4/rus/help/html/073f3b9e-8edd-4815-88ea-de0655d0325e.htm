<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Основные сведения о поддержке SSL</title><meta name="Language" content="ru-RU" /><meta name="System.Keywords" content="шифрование" /><meta name="System.Keywords" content="SSL" /><meta name="Microsoft.Help.Id" content="073f3b9e-8edd-4815-88ea-de0655d0325e" /><meta name="Description" content="При соединении с SQL Server драйвер Драйвер Microsoft JDBC для SQL Server выполняет SSL-подтверждение, если приложение запросило шифрование и для экземпляра SQL Server настроена поддержка SSL-шифрования." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Основные сведения о поддержке SSL</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>При соединении с SQL Server драйвер Драйвер Microsoft JDBC для SQL Server выполняет SSL-подтверждение, если приложение запросило шифрование и для экземпляра SQL Server настроена поддержка SSL-шифрования. Подтверждение обеспечивает возможность согласования сервером и клиентом алгоритмов шифрования, используемых для защиты данных. SSL-подтверждение обеспечивает защищенную передачу данных между клиентом и сервером. В ходе SSL-подтверждения сервер отправляет сертификат открытого ключа клиенту. Поставщик сертификата открытого ключа называется центром сертификации (ЦС). Клиент несет ответственность за проверку надежности используемого центра сертификации.</p><p>Если приложение не запрашивает шифрования по протоколу SSL, то драйвер Драйвер Microsoft JDBC для SQL Server не будет принудительно включать в SQL Server его поддержку. Если в экземпляре SQL Server не настроено принудительное SSL-шифрование, то соединение устанавливается без шифрования. Если в экземпляре SQL Server настроено принудительное SSL-шифрование, то драйвер автоматически включит SSL-шифрование при запуске на правильно настроенной виртуальной машине Java (JVM), в противном случае соединение будет разорвано, а в драйвере возникнет ошибка.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Чтобы подключение по протоколу SSL было выполнено успешно, убедитесь, что переданное в параметре <span sdata="langKeyword" value="serverName"><span class="keyword">serverName</span></span> значение в точности совпадает с общим именем (CN) или DNS-именем в SAN в сертификате сервера.</p></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Дополнительные сведения о настройке SSL-шифрования в SQL Server см. в разделе «Шифрование соединений с SQL Server» электронной документации по SQL Server.</p></div></div><h1 class="heading">Примечания</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>Чтобы разрешить использование SSL-шифрования приложением, в драйвере Драйвер Microsoft JDBC для SQL Server, начиная с версии 1.2, появились следующие свойства соединения: <span class="label">encrypt</span>, <span class="label">trustServerCertificate</span>, <span class="label">trustStore</span>, <span class="label">trustStorePassword</span> и <span class="label">hostNameInCertificate</span>. Дополнительные сведения см. в разделе <span sdata="link"><a href="f1b62700-f046-488d-bd6b-a5cd8fc345b7.htm">Задание свойств соединения</a></span>.</p><p>В следующей таблице перечислены режимы работы Драйвер Microsoft JDBC для SQL Server в различных возможных вариантах SSL-соединений. Во всех вариантах используются различные наборы свойств SSL-соединений. В таблицу входят: </p><ul><li><p><span sdata="langKeyword" value="blank"><span class="keyword">blank</span></span>: «Свойство отсутствует в строке соединения»</p></li><li><p><span sdata="langKeyword" value="value"><span class="keyword">value</span></span>: «Свойство существует в строке соединения и имеет допустимое значение»</p></li><li><p><span sdata="langKeyword" value="any"><span class="keyword">any</span></span>: «Наличие свойства в строке соединения и допустимость его значения не проверяются»</p></li></ul><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>То же происходит и при проверке подлинности пользователей SQL Server и встроенной проверке подлинности Windows.</p></div><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>encrypt</p></th><th><p>trustServerCertificate</p></th><th><p>hostNameInCertificate</p></th><th><p>trustStore</p></th><th><p>trustStorePassword</p></th><th><p>Режим работы</p></th></tr><tr><td><p>false or blank</p></td><td><p>any</p></td><td><p>any</p></td><td><p>any</p></td><td><p>any</p></td><td><p>Драйвер Драйвер Microsoft JDBC для SQL Server не включает в SQL Server SSL-шифрования принудительно. Если на сервере имеется самозаверяющий сертификат, драйвер запускает обмен SSL-сертификатами. SSLсертификат не будет проверяться, а шифроваться будут только учетные данные (в пакете входа).</p><p>Если сервер требует от клиента поддержки SSL-шифрования, драйвер запускает обмен SSL-сертификатами. Проверка SSL-сертификатов не будет выполняться, а будет выполняться шифрование всего сеанса связи.</p></td></tr><tr><td><p>true</p></td><td><p>true</p></td><td><p>any</p></td><td><p>any</p></td><td><p>any</p></td><td><p>Драйвер Драйвер Microsoft JDBC для SQL Server запрашивает использование SSL-шифрования в SQL Server. </p><p>Если сервер требует от клиента поддерживать SSL-шифрование или сам поддерживает шифрование, драйвер запускает обмен SSL-сертификатами. Обратите внимание, что если свойство <span class="label">trustServerCertificate</span> имеет значение "true", то драйвер не будет выполнять проверку SSL-сертификата.</p><p>Если на сервере не настроена поддержка шифрования, то в работе драйвера будет вызвана ошибка и соединение будет разорвано.</p></td></tr><tr><td><p>true</p></td><td><p>false or blank</p></td><td><p>blank</p></td><td><p>blank</p></td><td><p>blank</p></td><td><p>Драйвер Драйвер Microsoft JDBC для SQL Server запрашивает использование SSL-шифрования в SQL Server. </p><p>Если сервер требует от клиента поддерживать SSL-шифрование или сам поддерживает шифрование, драйвер запускает обмен SSL-сертификатами. </p><p>Драйвер будет использовать для проверки SSL-сертификата свойство <span class="label">serverName</span>, указанное в URL-адресе соединения, а выбор хранилища сертификатов для использования будет зависеть от правил поиска фабрики.</p><p>Если на сервере не настроена поддержка шифрования, то в работе драйвера будет вызвана ошибка и соединение будет разорвано.</p></td></tr><tr><td><p>true</p></td><td><p>false or blank</p></td><td><p>value</p></td><td><p>blank</p></td><td><p>blank</p></td><td><p>Драйвер Драйвер Microsoft JDBC для SQL Server запрашивает использование SSL-шифрования в SQL Server. </p><p>Если сервер требует от клиента поддерживать SSL-шифрование или сам поддерживает шифрование, драйвер запускает обмен SSL-сертификатами. </p><p>Драйвер проверяет значение субъекта SSL-сертификата с помощью значения, указанного в свойстве <span class="label">hostNameInCertificate</span>.</p><p>Если на сервере не настроена поддержка шифрования, то в работе драйвера будет вызвана ошибка и соединение будет разорвано.</p></td></tr><tr><td><p>true</p></td><td><p>false or blank</p></td><td><p>blank</p></td><td><p>value</p></td><td><p>value</p></td><td><p>Драйвер Драйвер Microsoft JDBC для SQL Server запрашивает использование SSL-шифрования в SQL Server. </p><p>Если сервер требует от клиента поддерживать SSL-шифрование или сам поддерживает шифрование, драйвер запускает обмен SSL-сертификатами. </p><p>Драйвер использует значение свойства <span class="label">trustStore</span> для поиска файла сертификата trustStore и значение свойства <span class="label">trustStorePassword</span> для проверки целостности файла trustStore.</p><p>Если на сервере не настроена поддержка шифрования, то в работе драйвера будет вызвана ошибка и соединение будет разорвано.</p></td></tr><tr><td><p>true</p></td><td><p>false or blank</p></td><td><p>blank</p></td><td><p>blank</p></td><td><p>value</p></td><td><p>Драйвер Драйвер Microsoft JDBC для SQL Server запрашивает использование SSL-шифрования в SQL Server.</p><p>Если сервер требует от клиента поддерживать SSL-шифрование или сам поддерживает шифрование, драйвер запускает обмен SSL-сертификатами. </p><p>Драйвер использует значение свойства <span class="label">trustStorePassword</span> для проверки целостности файла trustStore, выбранного по умолчанию.</p><p>Если на сервере не настроена поддержка шифрования, то в работе драйвера будет вызвана ошибка и соединение будет разорвано.</p></td></tr><tr><td><p>true</p></td><td><p>false or blank</p></td><td><p>blank</p></td><td><p>value</p></td><td><p>blank</p></td><td><p>Драйвер Драйвер Microsoft JDBC для SQL Server запрашивает использование SSL-шифрования в SQL Server. </p><p>Если сервер требует от клиента поддерживать SSL-шифрование или сам поддерживает шифрование, драйвер запускает обмен SSL-сертификатами. </p><p>Драйвер использует значение свойства <span class="label">trustStore</span> для поиска местоположения файла trustStore.</p><p>Если на сервере не настроена поддержка шифрования, то в работе драйвера будет вызвана ошибка и соединение будет разорвано.</p></td></tr><tr><td><p>true</p></td><td><p>false or blank</p></td><td><p>value</p></td><td><p>blank</p></td><td><p>value</p></td><td><p>Драйвер Драйвер Microsoft JDBC для SQL Server запрашивает использование SSL-шифрования в SQL Server. </p><p>Если сервер требует от клиента поддерживать SSL-шифрование или сам поддерживает шифрование, драйвер запускает обмен SSL-сертификатами. </p><p>Драйвер использует значение свойства <span class="label">trustStorePassword</span> для проверки целостности файла trustStore, выбранного по умолчанию. Драйвер также использует значение свойства <span class="label">hostNameInCertificate</span> для проверки SSL-сертификата.</p><p>Если на сервере не настроена поддержка шифрования, то в работе драйвера будет вызвана ошибка и соединение будет разорвано.</p></td></tr><tr><td><p>true</p></td><td><p>false or blank</p></td><td><p>value</p></td><td><p>value</p></td><td><p>blank</p></td><td><p>Драйвер Драйвер Microsoft JDBC для SQL Server запрашивает использование SSL-шифрования в SQL Server. </p><p>Если сервер требует от клиента поддерживать SSL-шифрование или сам поддерживает шифрование, драйвер запускает обмен SSL-сертификатами. </p><p>Драйвер использует значение свойства <span class="label">trustStore</span> для поиска местоположения файла trustStore. Драйвер также использует значение свойства <span class="label">hostNameInCertificate</span> для проверки SSL-сертификата.</p><p>Если на сервере не настроена поддержка шифрования, то в работе драйвера будет вызвана ошибка и соединение будет разорвано.</p></td></tr><tr><td><p>true</p></td><td><p>false or blank</p></td><td><p>value</p></td><td><p>value</p></td><td><p>value</p></td><td><p>Драйвер Драйвер Microsoft JDBC для SQL Server запрашивает использование SSL-шифрования в SQL Server. </p><p>Если сервер требует от клиента поддерживать SSL-шифрование или сам поддерживает шифрование, драйвер запускает обмен SSL-сертификатами. </p><p>Драйвер использует значение свойства <span class="label">trustStore</span> для поиска файла сертификата trustStore и значение свойства <span class="label">trustStorePassword</span> для проверки целостности файла trustStore. Драйвер также использует значение свойства <span class="label">hostNameInCertificate</span> для проверки SSL-сертификата.</p><p>Если на сервере не настроена поддержка шифрования, то в работе драйвера будет вызвана ошибка и соединение будет разорвано.</p></td></tr></table></div><p>Если для свойства encrypt задано значение <span sdata="langKeyword" value="true"><span class="keyword">true</span></span>, то драйвер Драйвер Microsoft JDBC для SQL Server использует для согласования SSL-шифрования с SQL Server поставщик безопасности JSSE в виртуальной машине Java, настроенный по умолчанию. Поставщик безопасности по умолчанию может не поддерживать все функции, необходимые для успешного согласования SSL-шифрования. Например, поставщик безопасности по умолчанию может не поддерживать размер открытого ключа RSA, используемого в SSL-сертификате SQL Server. В этом случае поставщик безопасности по умолчанию может вызвать ошибку, в результате которой драйвер JDBC разорвет соединение. Чтобы устранить эту неполадку, выполните одно из следующих действий.</p><ul><li><p>Настройка SQL Server с использованием сертификата сервера с меньшим открытым ключом RSA</p></li><li><p>Настройте в JVM использование другого поставщика безопасности JSSE в файле свойств безопасности «&lt;java-home&gt;/lib/security/java.security».</p></li><li><p>Используйте другой JVM</p></li></ul></div><h1 class="heading">Проверка SSL-сертификата сервера</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>В ходе SSL-подтверждения сервер отправляет сертификат открытого ключа клиенту. Драйвер JDBC или клиент должны обеспечить проверку того, что сертификат сервера выдан центром сертификации, которому доверяет клиент. Драйвер требует соответствия сертификата сервера следующим требованиям:</p><ul><li><p>Сертификат должен быть выдан доверенным центром сертификации.</p></li><li><p>Сертификат должен быть выдан для проверки подлинности серверов.</p></li><li><p>Сертификат является действительным на текущую дату.</p></li><li><p>Общее имя (CN) в свойстве субъекта сертификата или DNS-имя в имени SAN в сертификате точно соответствуют значению <span sdata="langKeyword" value="serverName"><span class="keyword">serverName</span></span>, указанному в строке соединения, или значению свойства <span sdata="langKeyword" value="hostNameInCertificate"><span class="keyword">hostNameInCertificate</span></span>, если оно указано.</p></li><li><p>DNS-имя может содержать символы шаблонов. Но драйвер Драйвер Microsoft JDBC для SQL Server не поддерживает сопоставление шаблонов. Это значит, что abc.com не сопоставится с *.com, но *.com будет успешно сопоставлено с *.com.</p></li></ul></div><span id="seeAlsoSpan"><h1 class="heading">См. также</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="8e566243-2f93-4b21-8065-3c8336649309.htm">Использование SSL-шифрования</a></span></div><div class="seeAlsoStyle"><span sdata="link"><a href="90724ec6-a9cb-43ef-903e-793f89410bc0.htm">Защита приложений драйвера JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Отправить <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dСпасибо%20за%20отзыв!%20Отзывы%20помогают%20команде%20разработчиков%20в%20улучшении%20документации.%20Просматривая%20ваши%20отзывы,%20корпорация%20Майкрософт%20может%20спросить%20по%20электронной%20почте%20ваше%20мнение,%20касающееся%20определенного%20решения.%20Адрес%20электронной%20почты%20не%20используется%20в%20других%20целях%20и%20удаляется%20корпорацией%20Майкрософт%20после%20завершения%20просмотра.%0\AДополнительные%20сведения%20о%20политике%20конфиденциальности%20корпорации%20Майкрософт%20см.%20на%20странице%20http://privacy.microsoft.com/ru-ru/default.aspx.%0\A%0\d','Отзывы%20пользователей.');">отзыв</a> об этом разделе в Майкрософт.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© © Корпорация Майкрософт (Microsoft Corporation), 2012 г. Все права защищены.</a></p></span></div></div></body></html>