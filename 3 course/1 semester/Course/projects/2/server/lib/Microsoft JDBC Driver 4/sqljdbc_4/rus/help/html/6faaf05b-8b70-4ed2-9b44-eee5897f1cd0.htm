<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Использование драйвера JDBC</title><meta name="Language" content="ru-RU" /><meta name="System.Keywords" content="Общие сведения о драйвере JDBC, драйвер JDBC, использование" /><meta name="Microsoft.Help.Id" content="6faaf05b-8b70-4ed2-9b44-eee5897f1cd0" /><meta name="Description" content="В этом разделе приведены краткие указания по установлению простого соединения с базой данных SQL Server с использованием драйвера Драйвер Microsoft JDBC для SQL Server." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Использование драйвера JDBC</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>В этом разделе приведены краткие указания по установлению простого соединения с базой данных SQL Server с использованием драйвера Драйвер Microsoft JDBC для SQL Server. Перед соединением с базой данных SQL Server необходимо установить SQL Server на локальном компьютере или на сервере, а также установить драйвер JDBC на локальном компьютере. </p></div><h1 class="heading">Выбор нужного JAR-файла</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>Драйвер Драйвер Microsoft JDBC для SQL Server включает файлы библиотек классов <span sdata="langKeyword" value="sqljdbc.jar"><span class="keyword">sqljdbc.jar</span></span> и <span sdata="langKeyword" value="sqljdbc4.jar"><span class="keyword">sqljdbc4.jar</span></span>, которые используются в зависимости от выбранных параметров среды выполнения Java (JRE). Дополнительные сведения о том, какие файлы JAR следует выбрать, см. в разделе <span sdata="link"><a href="447792bb-f39b-49b4-9fd0-1ef4154c74ab.htm">Системные требования для драйверов JDBC</a></span>.</p></div><h1 class="heading">Задание пути к классу</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>Драйвер JDBC не входит в пакет Java SDK. Если нужно его использовать, необходимо включить в путь к классу файл sqljdbc.jar или sqljdbc4.jar. Если в пути к классу не указан файл sqljdbc.jar или sqljdbc4.jar, то приложение вызовет общее исключение «Класс не найден».</p><p>Файлы sqljdbc.jar и sqljdbc4.jar устанавливаются в следующую папку:</p><p>&lt;<span class="placeholder">installation directory</span>&gt;\sqljdbc_&lt;<span class="placeholder">version</span>&gt;\&lt;<span class="placeholder">language</span>&gt;\sqljdbc.jar</p><p>&lt;<span class="placeholder">installation directory</span>&gt;\sqljdbc_&lt;<span class="placeholder">version</span>&gt;\&lt;<span class="placeholder">language</span>&gt;\sqljdbc4.jar</p><p>Далее представлен пример инструкции CLASSPATH, используемой для приложения Windows.</p><p><span class="code">CLASSPATH =.;C:\Program Files\Microsoft JDBC Driver 4.0 for SQL Server\sqljdbc_4.0\enu\sqljdbc.jar</span></p><p>Далее представлен пример инструкции CLASSPATH, используемой для приложения Unix/Linux.</p><p><span class="code">CLASSPATH =.:/home/usr1/mssqlserverjdbc/Driver/sqljdbc_4.0/enu/sqljdbc.jar</span></p><p>Необходимо убедиться в том, что в инструкции CLASSPATH содержится только один драйвер Драйвер Microsoft JDBC для SQL Server, то есть либо sqljdbc.jar, либо sqljdbc4.jar.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>В системах Windows имена каталогов длиной более 8 символов (+ 3 символа расширения) и имена папок, содержащие пробелы, могут вызывать проблемы с путями к классу. Если предполагаются проблемы такого типа, следует временно переместить файл sqljdbc.jar или sqljdbc4.jar в каталог с простым именем, например<span class="code"> C:\Temp</span>, изменить путь к классу и проверить, устранена ли проблема.</p></div><h1 class="heading">Приложения, которые выполняются непосредственно в командной строке</h1><div class="subsection"><p>Путь к классу настраивается в операционной системе. Добавьте в путь к классу в системе файл sqljdbc.jar или sqljdbc4.jar. Также можно указать путь к классу в командной строке Java, которая запускает приложения, воспользовавшись параметром<span class="code"> java -classpath</span>.</p></div><h1 class="heading">Приложения, выполняющиеся в интегрированной среде разработки</h1><div class="subsection"><p>Каждый поставщик интегрированной среды разработки предоставляет собственный метод задания пути к классу в среде. Простой установки пути к классу в операционной системе недостаточно. Необходимо добавить файл sqljdbc.jar или sqljdbc4.jar к пути к классу в интегрированной среде разработки.</p></div><h1 class="heading">Сервлеты и JSP</h1><div class="subsection"><p>Сервлеты и JSP выполняются в подсистеме сервлетов/JSP, например Tomcat. Путь к классу необходимо установить в соответствии с документацией по подсистеме сервлетов/JSP. Простой установки пути к классу в операционной системе недостаточно. Некоторые подсистемы сервлетов/JSP выводят окна установка, в которых можно задать путь к классу. В этом случае необходимо добавить к существующему пути к классу подсистемы нужный JAR-файл драйвера JDBC и перезапустить подсистему. В остальных случаях можно развернуть драйвер, скопировав файл sqljdbc.jar или sqljdbc4.jar в определенный каталог (например, lib) во время установки подсистемы. Путь к классу драйвера подсистемы также можно указать в файле конфигурации для подсистемы.</p></div><h1 class="heading">Enterprise Java Beans</h1><div class="subsection"><p>Компоненты Enterprise Java Beans (EJB) выполняются в контейнере EJB. Контейнеры EJB предоставляются различными поставщиками. Java-приложения работают в браузере, но загружаются с веб-сервера. Скопируйте файл sqljdbc.jar или sqljdbc4.jar в корневой каталог веб-сервера и укажите имя JAR-файл на вкладке HTML-архива приложения, например <span class="code">&lt;applet ... archive=sqljdbc.jar&gt;</span>.</p></div></div><h1 class="heading">Установление простого соединения с базой данных</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>В случае использования библиотеки классов sqljdbc.jar приложения сначала должны зарегистрировать драйвер следующим образом:</p><p><span class="code">Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");</span></p><p>После загрузки драйвера можно установить соединение, используя URL-адрес соединения и метод <b>getConnection</b> класса <b>DriverManager</b>:</p><div class="sampleCode"><span codeLanguage="other"><pre>String connectionUrl = "jdbc:sqlserver://localhost:1433;" +
   "databaseName=AdventureWorks;user=MyUserName;password=*****;";
Connection con = DriverManager.getConnection(connectionUrl);</pre></span></div><p>В JDBC API 4.0 метод <b>DriverManager.getConnection</b> усовершенствован и автоматически загружает драйверы JDBC. Поэтому в случае использования библиотеки классов sqljdbc4.jar приложениям не обязательно вызывать метод <b>Class.forName</b> для регистрации или загрузки драйвера.</p><p>Когда вызывается метод <b>getConnection</b> класса <b>DriverManager</b>, из набора зарегистрированных драйверов JDBC выбирается подходящий драйвер. Файл sqljdbc4.jar содержит файл «META-INF/services/java.sql.Driver», который содержит зарегистрированный драйвер <span sdata="langKeyword" value="com.microsoft.sqlserver.jdbc.SQLServerDriver"><span class="keyword">com.microsoft.sqlserver.jdbc.SQLServerDriver</span></span>. Существующие приложения, которые загружают драйверы с помощью метода <b>Class.forName</b>, продолжат работать, не требуя изменений.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Для библиотеки классов sqljdbc4.jar необходима среда выполнения Java (JRE) версии 6.0 или более поздней.</p></div><p>Дополнительные сведения о соединении с источниками данных и использовании URL-адреса соединения см. в разделах <span sdata="link"><a href="44996746-d373-4f59-9863-a8a20bb8024a.htm">Формирование URL-адреса соединения</a></span> и <span sdata="link"><a href="f1b62700-f046-488d-bd6b-a5cd8fc345b7.htm">Задание свойств соединения</a></span>.</p></div><span id="seeAlsoSpan"><h1 class="heading">См. также</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="939a8773-2583-49a4-bf00-6b892fbe39dc.htm">Общие сведения о драйвере JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Отправить <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dСпасибо%20за%20отзыв!%20Отзывы%20помогают%20команде%20разработчиков%20в%20улучшении%20документации.%20Просматривая%20ваши%20отзывы,%20корпорация%20Майкрософт%20может%20спросить%20по%20электронной%20почте%20ваше%20мнение,%20касающееся%20определенного%20решения.%20Адрес%20электронной%20почты%20не%20используется%20в%20других%20целях%20и%20удаляется%20корпорацией%20Майкрософт%20после%20завершения%20просмотра.%0\AДополнительные%20сведения%20о%20политике%20конфиденциальности%20корпорации%20Майкрософт%20см.%20на%20странице%20http://privacy.microsoft.com/ru-ru/default.aspx.%0\A%0\d','Отзывы%20пользователей.');">отзыв</a> об этом разделе в Майкрософт.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© © Корпорация Майкрософт (Microsoft Corporation), 2012 г. Все права защищены.</a></p></span></div></div></body></html>