<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Программирование с SQLXML.</title><meta name="Language" content="ru-RU" /><meta name="System.Keywords" content="адаптивная буферизация" /><meta name="System.Keywords" content="программирование с sqlxml" /><meta name="System.Keywords" content="sqlxml" /><meta name="System.Keywords" content="xml" /><meta name="Microsoft.Help.Id" content="4d2cc57c-7293-4d92-b8b1-525e2b35f591" /><meta name="Description" content="В этом разделе описано использование методов API драйвера Драйвер Microsoft JDBC для SQL Server для сохранения XML-документа в реляционной базе данных и извлечения документов из нее с помощью объектов SQLXML." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Программирование с SQLXML.</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>В этом разделе описано использование методов API драйвера Драйвер Microsoft JDBC для SQL Server для сохранения XML-документа в реляционной базе данных и извлечения документов из нее с помощью объектов <span sdata="langKeyword" value="SQLXML"><span class="keyword">SQLXML</span></span>. </p><p>В этом разделе также содержатся сведения о типах объектов SQLXML и список важных рекомендаций и ограничений при работе с объектами SQLXML.</p></div><h1 class="heading">Чтение и запись XML-данных с использованием объектов SQLXML</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>В следующем списке описывается использование методов API Драйвер Microsoft JDBC для SQL Server для чтения и записи XML-данных с использованием объектов SQLXML.</p><ul><li><p>Для создания объекта SQLXML используйте метод <a href="cf5bfcdd-bc03-4c5b-b554-d8a8a4067e93.htm">createSQLXML</a> класса <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a>. Обратите внимание, что этот метод создает объект SQLXML без данных. Чтобы добавить данные <span sdata="langKeyword" value="xml"><span class="keyword">xml</span></span> к объекту SQLXML, вызовите один из следующих методов, указанных в интерфейсе SQLXML: <b>setResult</b>, <b>setCharacterStream</b>, <b>setBinaryStream</b>, или <b>setString</b>.</p></li><li><p>Чтобы извлечь сам объект SQLXML, используйте методы <b>getSQLXML</b> класса <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a> или класса <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a>. </p></li><li><p>Чтобы извлечь данные <span sdata="langKeyword" value="xml"><span class="keyword">xml</span></span> из объекта SQLXML, используйте один из следующих методов, указанных в интерфейсе SQLXML: <b>getSource</b>, <b>getCharacterStream</b>, <b>getBinaryStream</b>, или <b>getString</b>. </p></li><li><p>Чтобы обновить данные <span sdata="langKeyword" value="xml"><span class="keyword">xml</span></span> в объекте SQLXML, используйте метод <a href="abe8ff37-72e5-4ec1-a226-6b68dbf2c1b4.htm">updateSQLXML</a> класса <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a>.</p></li><li><p>Чтобы сохранить объект SQLXML в столбце таблицы базы данных типа <span sdata="langKeyword" value="xml"><span class="keyword">xml</span></span>, используйте методы  <b>setSQLXML</b> класса <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> или класса <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a>.</p></li></ul><p>В примере кода в <a href="8f2ff25b-71fd-46d7-b6de-d656095d2aad.htm">SQLXML Data Type Sample</a> показывается выполнение общих задач API. </p></div><h1 class="heading">Читаемые и записываемые объекты SQLXML</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>В следующей таблице перечислены типы объектов SQLXML, поддерживаемые методами задания, считывания и обновления свойств, предоставленными JDBC API. Столбцы в таблице ссылаются на следующее: </p><ul><li><p>В столбце <b>Имя метода</b> перечислены поддерживаемые методы задания, считывания и обновления в JDBC API.</p></li><li><p>Столбец <b>Объект считывания SQLXML</b> представляет объект SQLXML, созданный методом <a href="8bcf9eda-b36c-480c-8bf2-91c392d5a0ee.htm">getSQLXML</a> класса <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> или методом  <a href="a07e0f30-cbc6-4ad7-b931-c30cad382e64.htm">getSQLXML</a> класса <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a>.</p></li><li><p>Столбец <b>Объект задания SQLXML</b> представляет объект SQLXML, созданный методом <a href="cf5bfcdd-bc03-4c5b-b554-d8a8a4067e93.htm">createSQLXML</a> класса <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a>. Обратите внимание, что метод задания, описанный ниже, принимает только объект SQLXML, созданный методом <a href="cf5bfcdd-bc03-4c5b-b554-d8a8a4067e93.htm">createSQLXML</a>.</p></li></ul><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Имя метода </p></th><th><p>Объект считывания SQLXML</p><p>(читаемый)</p></th><th><p>Объект задания SQLXML</p><p>(записываемый)</p></th></tr><tr><td><p><b>CallableStatement.setSQLXML()</b></p></td><td><p>Не поддерживается</p></td><td><p>Поддерживается</p></td></tr><tr><td><p><b>CallableStatement.setObject()</b></p></td><td><p>Не поддерживается</p></td><td><p>Поддерживается</p></td></tr><tr><td><p><b>PreparedStatement.setSQLXML()</b></p></td><td><p>Не поддерживается</p></td><td><p>Поддерживается</p></td></tr><tr><td><p><b>PreparedStatement.setObject()</b></p></td><td><p>Не поддерживается</p></td><td><p>Поддерживается</p></td></tr><tr><td><p><b>ResultSet.updateSQLXML()</b></p></td><td><p>Не поддерживается</p></td><td><p>Поддерживается</p></td></tr><tr><td><p><b>ResultSet.updateObject()</b></p></td><td><p>Не поддерживается</p></td><td><p>Поддерживается</p></td></tr><tr><td><p><b>ResultSet.getSQLXML()</b></p></td><td><p>Поддерживается</p></td><td><p>Не поддерживается</p></td></tr><tr><td><p><b>CallableStatement.getSQLXML()</b></p></td><td><p>Поддерживается</p></td><td><p>Не поддерживается</p></td></tr></table></div><p>Как показано в таблице выше, методы задания SQLXML не будут работать при использовании с читаемыми объектами SQLXML; аналогичным образом методы считывания не будут работать при использовании с записываемыми объектами SQLXML.</p><p>Если приложение вызывает метод <b>setObject</b> с помощью указания параметра масштаба или длины объекта SQLXML, параметр масштаба или длины пропускается.</p></div><h1 class="heading">Рекомендации и ограничения при использовании объектов SQLXML</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>Приложения могут использовать объекты SQLXML для чтения и записи данных XML в базе данных. В следующем списке содержатся сведения об определенных ограничениях и рекомендациях при использовании объектов SQLXML: </p><ul><li><p>Объект SQLXML является действительным только во время выполнении транзакции, в которой он был создан.</p></li><li><p>Объект SQLXML, полученный методом считывания, может быть использован только для чтения данных. </p></li><li><p>Объект SQLXML, созданный методом соединения, может быть использован только для записи данных.</p></li><li><p>Приложение может вызвать только один метод считывания на читаемом объекте SQLXML для чтения данных. После вызова метода считывания в работе всех остальных методов считывания и задания на этом же объекте SQLXML произойдет ошибка. </p></li><li><p>Приложение может вызвать метод <b>free</b> на объекте SQLXML только после его чтения или записи. Однако еще сохраняется возможность обработки возвращенного потока или источника, если базовый столбец или параметр активен. Если базовый столбец или параметр становится неактивен, то будет закрыт поток или источник, связанный с объектом SQLXML. Если базовый столбец или параметр более не является допустимым, то базовые данные будут недоступны для методов считывания Stream, Simple API for XML (SAX) и Streaming API for XML (StAX).</p></li><li><p>Приложение может вызвать только один метод задания на записываемом объекте SQLXML. После вызова метода задания в работе всех остальных методов считывания и задания на этом же объекте SQLXML произойдет ошибка.</p></li><li><p>Чтобы задать данные для объекта SQLXML, приложение должно использовать соответствующий метод задания и функции в возвращенном объекте.</p></li><li><p>Методы <b>getSQLXML</b> классов <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> и <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a> возвращают данные <span sdata="langKeyword" value="null"><span class="keyword">null</span></span>, если для базового столбца задано значение <span sdata="langKeyword" value="null"><span class="keyword">null</span></span>.</p></li><li><p>Объекты метода задания являются допустимыми в период выполнения соединения, в котором они были созданы.</p></li><li><p>Приложения не могут задавать значение <span sdata="langKeyword" value="null"><span class="keyword">null</span></span> с помощью методов задания, предоставленных интерфейсом SQLXML. Приложения могут задавать пустую строку с помощью методов задания, предоставленных в интерфейсе SQLXML. Чтобы задать значение <span sdata="langKeyword" value="null"><span class="keyword">null</span></span>, приложения должны вызвать одно из следующих:</p><ul><li><p>Методы <b>setNull</b> классов <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> и <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a>.</p></li><li><p>Методы <b>setObject</b> классов <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> и <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a>. </p></li><li><p>Методы <b>setSQLXML</b> классов <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> и <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> со значением параметра <span sdata="langKeyword" value="null"><span class="keyword">null</span></span>.</p></li></ul></li><li><p>При работе с XML-документами рекомендуется использовать средства синтаксического анализа Simple API for XML (SAX) и Streaming API for XML (StAX) вместо средств синтаксического анализа модели DOM, т.к. они обеспечивают более высокий уровень производительности.</p></li></ul><p>Средства синтаксического анализа XML не могут обрабатывать пустые значения. Однако SQL Server позволяет приложениям извлекать и сохранять пустые значения в столбцах баз данных типа данных XML. Это означает, что если базовое значение пустое, то при синтаксическом анализе XML-данных средство синтаксического анализа вызовет исключение. При использовании выходных значений DOM драйвер JDBC обрабатывает это исключение и вызывает ошибку. При работе с выходными значениями SAX и Stax ошибка вызывается средством синтаксического анализа напрямую.</p></div><h1 class="heading">Адаптивная буферизация и поддержка SQLXML</h1><div id="sectionSection3" class="section" name="collapseableSection" style=""><p>Двоичные и символьные потоки, возвращаемые объектом SQLXML, поддерживают режимы адаптивной и полной буферизации. С другой стороны, если средства синтаксического анализа XML не являются потоками, они не поддерживают настройки адаптивной и полной буферизации. Дополнительные сведения об адаптивной буферизации см. в разделе <span sdata="link"><a href="92d4e3be-c3e9-4732-9a60-b57f4d0f7cb7.htm">Использование адаптивной буферизации</a></span>.</p></div><span id="seeAlsoSpan"><h1 class="heading">См. также</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="32b7217e-1f0c-473d-9a45-176daa81584e.htm">Поддержка XML-данных</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Отправить <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dСпасибо%20за%20отзыв!%20Отзывы%20помогают%20команде%20разработчиков%20в%20улучшении%20документации.%20Просматривая%20ваши%20отзывы,%20корпорация%20Майкрософт%20может%20спросить%20по%20электронной%20почте%20ваше%20мнение,%20касающееся%20определенного%20решения.%20Адрес%20электронной%20почты%20не%20используется%20в%20других%20целях%20и%20удаляется%20корпорацией%20Майкрософт%20после%20завершения%20просмотра.%0\AДополнительные%20сведения%20о%20политике%20конфиденциальности%20корпорации%20Майкрософт%20см.%20на%20странице%20http://privacy.microsoft.com/ru-ru/default.aspx.%0\A%0\d','Отзывы%20пользователей.');">отзыв</a> об этом разделе в Майкрософт.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© © Корпорация Майкрософт (Microsoft Corporation), 2012 г. Все права защищены.</a></p></span></div></div></body></html>