<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Использование Escape-последовательностей SQL</title><meta name="Language" content="ru-RU" /><meta name="System.Keywords" content="Escape-последовательности SQL" /><meta name="Microsoft.Help.Id" content="00f9e25a-088e-4ac6-aa75-43eacace8f03" /><meta name="Description" content="Драйвер Microsoft JDBC для SQL Server поддерживает использование escape-последовательностей SQL, описанных в определении API JDBC." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Использование Escape-последовательностей SQL</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Драйвер Microsoft JDBC для SQL Server поддерживает использование escape-последовательностей SQL, описанных в определении API JDBC. Escape-последовательности используются в инструкции SQL для передачи драйверу сведений о том, что экранированные части SQL-строки должны обрабатываться иначе. При обработке драйвером JDBC части escape-последовательности SQL-строки выполняется преобразование этой части строки в SQL-код, распознаваемый SQL Server. </p><p>Существует пять типов escape-последовательностей, требуемых API JDBC, и все они поддерживаются драйвером JDBC:</p><ul><li><p>Литералы-шаблоны LIKE</p></li><li><p>Обработка функций</p></li><li><p>Литералы даты и времени</p></li><li><p>Вызовы хранимых процедур</p></li><li><p>Внешние соединения</p></li></ul><p>Драйвер JDBC использует следующий синтаксис escape-последовательности:</p><p><span class="code">{keyword ...parameters...}</span></p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Для драйвера JDBC всегда включена обработка escape-последовательностей SQL.</p></div><p>В следующих разделах описывается пять типов escape-последовательностей и способы их поддержки драйвером JDBC.</p></div><h1 class="heading">Литералы-шаблоны LIKE</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>Драйвер JDBC поддерживает синтаксис <span class="code">{escape 'escape character'}</span> для использования шаблонов предложения LIKE в качестве литералов. Например, в следующем коде возвращаются значения col3, для которых значение col2 начинается с символа подчеркивания (и не используется как шаблон).</p><div class="sampleCode"><span codeLanguage="other"><pre>ResultSet rst = stmt.executeQuery("SELECT col3 FROM test1 WHERE col2 
LIKE '\\_%' {escape '\\'}");</pre></span></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Escape-последовательность должна быть в конце инструкции SQL. При наличии в командной строке нескольких инструкций SQL escape-последовательность должна быть в конце каждой соответствующей инструкции SQL.</p></div></div><h1 class="heading">Обработка функций</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>Драйвер JDBC поддерживает использование escape-последовательностей функций в инструкциях SQL со следующим синтаксисом:</p><div class="sampleCode"><span codeLanguage="other"><pre>{fn functionName}</pre></span></div><p>где <span class="code">functionName</span> представляет собой функцию, поддерживаемую драйвером JDBC. Например:</p><div class="sampleCode"><span codeLanguage="other"><pre>SELECT {fn UCASE(Name)} FROM Employee</pre></span></div><p>В следующей таблице перечислены различные функции, поддерживаемые драйвером JDBC при использовании escape-последовательностей функций:</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Строковые функции</p></th><th><p>Числовые функции</p></th><th><p>Функции Datetime</p></th><th><p>Системные функции</p></th></tr><tr><td><p>ASCII</p><p>CHAR</p><p>CONCAT</p><p>DIFFERENCE</p><p>INSERT</p><p>LCASE</p><p>LEFT</p><p>LENGTH</p><p>LOCATE</p><p>LTRIM</p><p>REPEAT</p><p>REPLACE</p><p>RIGHT</p><p>RTRIM</p><p>SOUNDEX</p><p>SPACE</p><p>SUBSTRING</p><p>UCASE</p></td><td><p>ABS</p><p>ACOS</p><p>ASIN</p><p>ATAN</p><p>ATAN2</p><p>CEILING</p><p>COS</p><p>COT</p><p>DEGREES</p><p>EXP</p><p>FLOOR</p><p>LOG</p><p>LOG10</p><p>MOD</p><p>PI</p><p>POWER</p><p>RADIANS</p><p>RAND</p><p>ROUND</p><p>SIGN</p><p>SIN</p><p>SQRT</p><p>TAN</p><p>TRUNCATE</p></td><td><p>CURDATE</p><p>CURTIME</p><p>DAYNAME</p><p>DAYOFMONTH</p><p>DAYOFWEEK</p><p>DAYOFYEAR</p><p>EXTRACT</p><p>HOUR</p><p>MINUTE</p><p>MONTH</p><p>MONTHNAME</p><p>NOW</p><p>QUARTER</p><p>SECOND</p><p>TIMESTAMPADD</p><p>TIMESTAMPDIFF</p><p>WEEK</p><p>YEAR</p></td><td><p>DATABASE</p><p>IFNULL</p><p>USER</p></td></tr></table></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Использование функции, не поддерживаемой базой данных, приведет к возникновению ошибки.</p></div></div><h1 class="heading">Литералы даты и времени</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>Ниже приводится синтаксис escape-последовательности для литералов даты, времени и отметок времени: </p><div class="sampleCode"><span codeLanguage="other"><pre>{literal-type 'value'}</pre></span></div><p>где <span class="code">literal-type</span> является одним из следующих:</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Тип литерала</p></th><th><p>Описание</p></th><th><p>Формат значения</p></th></tr><tr><td><p>d</p></td><td><p>Дата</p></td><td><p>гггг-мм-дд</p></td></tr><tr><td><p>t</p></td><td><p>Измерение времени</p></td><td><p>чч:мм:сс [1]</p></td></tr><tr><td><p>ts</p></td><td><p>TimeStamp</p></td><td><p>гггг-мм-дд чч:мм:сс[.f...]</p></td></tr></table></div><p>Например:</p><div class="sampleCode"><span codeLanguage="other"><pre>UPDATE Orders SET OpenDate={d '2005-01-31'} 
WHERE OrderID=1025</pre></span></div></div><h1 class="heading">Вызовы хранимых процедур</h1><div id="sectionSection3" class="section" name="collapseableSection" style=""><p>Драйвер JDBC поддерживает синтаксис escape-последовательностей <span class="code">{? = call proc_name(?,...)}</span> и <span class="code">{call proc_name(?,...)}</span> для вызовов хранимых процедур, в зависимости от того, требуется ли обработка возвращаемого параметра. </p><p>Процедура представляет собой исполняемый объект, который хранится в базе данных. Обычно процедурой является одна или несколько заранее скомпилированных инструкций SQL. Ниже приводится синтаксис escape-последовательности вызова хранимой процедуры: </p><div class="sampleCode"><span codeLanguage="other"><pre>{[?=]call procedure-name[([parameter][,[parameter]]...)]}</pre></span></div><p>где <span class="code">procedure-name</span> указывает имя хранимой процедуры, а <span class="code">parameter</span> указывает параметр хранимой процедуры.</p><p>Дополнительные сведения об использовании escape-последовательностей <span class="code">call</span> с хранимыми процедурами см. в разделе <span sdata="link"><a href="0041f9e1-09b6-4487-b052-afd636c8e89a.htm">Использование инструкций с хранимыми процедурами</a></span>.</p></div><h1 class="heading">Внешние соединения</h1><div id="sectionSection4" class="section" name="collapseableSection" style=""><p>Драйвер JDBC поддерживает синтаксис левого, правого и полного внешнего соединения SQL92. Ниже приводится синтаксис escape-последовательности для внешних соединений:</p><div class="sampleCode"><span codeLanguage="other"><pre>{oj outer-join}</pre></span></div><p>где внешнее соединение:</p><div class="sampleCode"><span codeLanguage="other"><pre>table-reference {LEFT | RIGHT | FULL} OUTER JOIN  
{table-reference | outer-join} ON search-condition</pre></span></div><p>где <span class="code">table-reference</span> является именем таблицы, а <span class="code">search-condition</span> представляет собой условия соединения, которые необходимо использовать для таблиц.</p><p>Например:</p><div class="sampleCode"><span codeLanguage="other"><pre>SELECT Customers.CustID, Customers.Name, Orders.OrderID, Orders.Status 
   FROM {oj Customers LEFT OUTER JOIN 
      Orders ON Customers.CustID=Orders.CustID} 
   WHERE Orders.Status='OPEN'</pre></span></div><p>Драйвер JDBC поддерживает следующие escape-последовательности внешнего соединения:</p><ul><li><p>Левые внешние соединения</p></li><li><p>Правые внешние соединения</p></li><li><p>Полные внешние соединения</p></li><li><p>Вложенные внешние соединения</p></li></ul></div><span id="seeAlsoSpan"><h1 class="heading">См. также</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="7f8f3e8f-841e-4449-9154-b5366870121f.htm">Использование инструкций с драйвером JDBC</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Отправить <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dСпасибо%20за%20отзыв!%20Отзывы%20помогают%20команде%20разработчиков%20в%20улучшении%20документации.%20Просматривая%20ваши%20отзывы,%20корпорация%20Майкрософт%20может%20спросить%20по%20электронной%20почте%20ваше%20мнение,%20касающееся%20определенного%20решения.%20Адрес%20электронной%20почты%20не%20используется%20в%20других%20целях%20и%20удаляется%20корпорацией%20Майкрософт%20после%20завершения%20просмотра.%0\AДополнительные%20сведения%20о%20политике%20конфиденциальности%20корпорации%20Майкрософт%20см.%20на%20странице%20http://privacy.microsoft.com/ru-ru/default.aspx.%0\A%0\d','Отзывы%20пользователей.');">отзыв</a> об этом разделе в Майкрософт.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© © Корпорация Майкрософт (Microsoft Corporation), 2012 г. Все права защищены.</a></p></span></div></div></body></html>