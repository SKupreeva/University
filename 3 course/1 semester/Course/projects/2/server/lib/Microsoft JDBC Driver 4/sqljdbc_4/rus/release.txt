Сведения о версии
Драйвер Microsoft JDBC 4.0 для SQL Server
Март 2012 г.


ВВЕДЕНИЕ
------------
Этот документ содержит самые последние сведения и другие
важные дополнения к документации по драйверу Microsoft JDBC 4.0 
для SQL Server. Перед установкой драйвера JDBC следует полностью
прочитать этот файл.

Корпорация Майкрософт высоко ценит отзывы пользователей и прилагает
все усилия, чтобы своевременно реагировать на них. Сведения о передаче 
отзывов через блоги драйвера JDBC и форумы в сети см. 
на странице драйвера Microsoft JDBC 4.0 для SQL Server по адресу
http://msdn.microsoft.com/data/jdbc.


УСТАНОВКА
------------
Инструкции по установке драйвера JDBC приводятся в файле install.txt.
В этом файле даны сведения об установке драйвера JDBC 
в операционных системах Windows и Unix.

ПОДДЕРЖИВАЕМЫЕ ОПЕРАЦИОННЫЕ СИСТЕМЫ
---------------------------
Драйвер Microsoft JDBC 4.0 для SQL Server поддерживает следующие операционные системы: 
Linux, Unix, Windows Server 2008, 
Windows Vista с пакетом обновления 1 (SP1), Windows Server 2008 R2 и Windows 7.

В вышеприведенном списке представлены некоторые из поддерживаемых операционных систем.
Драйвер JDBC предназначен для работы в любой операционной системе, поддерживающей
использование виртуальной машины Java (JVM).  Однако официально протестированы только
системы Sun Solaris, SUSE Linux и Windows Vista с пакетом обновления 1 (SP1) и более поздние версии.

СОСТАВ РАСПРОСТРАНЯЕМОЙ ВЕРСИИ
----------------
Исполняемый ZIP-файл или TAR-файл драйвера Microsoft JDBC 4.0 для SQL Server 
распаковывает следующие файлы в указанное расположение относительно 
выбранного каталога установки:

<каталог_установки>\sqljdbc_<версия>\<language>\install.txt
<каталог_установки>\sqljdbc_<версия>\<language>\release.txt
<каталог_установки>\sqljdbc_<версия>\<language>\license.txt
<каталог_установки>\sqljdbc_<версия>\<язык>\sqljdbc.jar
<каталог_установки>\sqljdbc_<версия>\<язык>\sqljdbc4.jar
<каталог_установки>\sqljdbc_<версия>\<язык>\auth\x86\sqljdbc_auth.dll
<каталог_установки>\sqljdbc_<версия>\<язык>\auth\x64\sqljdbc_auth.dll
<каталог установки>\sqljdbc_<версия>\<язык>\help\default.htm
<каталог установки>\sqljdbc_<версия>\<язык>\help\index.htm
<каталог установки>\sqljdbc_<версия>\<язык>\help\toc.htm
<каталог установки>\sqljdbc_<версия>\<язык>\help\html\<страницы документа...>
<каталог установки>\sqljdbc_<версия>\<язык>\help\html\local\<файлы документа...>
<каталог установки>\sqljdbc_<версия>\<язык>\help\samples\<файлы образцов...>
<каталог_установки>\sqljdbc_<версия>\<язык>\xa\xa_install.sql
<каталог_установки>\sqljdbc_<версия>\<язык>\xa\x86\sqljdbc_xa.dll
<каталог_установки>\sqljdbc_<версия>\<язык>\xa\x64\sqljdbc_xa.dll


СПИСОК ИЗМЕНЕНИЙ
-----------
Изменения в версии 4.0 относительно версии 3.0.

1765616 DatabaseMetadata.getTypeInfo возвращает новые значения java.sql.Type для типа date, time, datetime2, datetimeoffset для Katmai и более поздних версий

1764334 Добавлена поддержка трассировки времени ожидания JDBC XA и идентификаторов ветвей транзакции (XID)

1750318 Функции SQLServerDatabaseMetaData будут работать корректно при повторном использовании соединения в составе пула.

1768845 Унифицировано поведение методов setTimestamp и updateTimestamp при округлении. Данные будут округляться 
        драйвером до 7 знаков после запятой перед передачей на сервер.

1770134 Применение метода updateTime к серверному типу времени с максимальным значением (23:59:59.999) приводит к верному округлению

1761042 Свойства DataSource Boolean вносят в журнал вызовы выхода

1750330 Обновлен скрипт XA SQL, чтобы избежать вводящих в заблуждение ошибок при первом запуске

1761393 Улучшена трассировка методов unwrap

1945579 DatabaseMetaData.getSchemas корректно функционирует с SQL Azure и SQL Server для всех параметров сортировки.

1963089 Свойство соединения hostNameInCertificate более не обязательно для проверки SSL-сертификата на соответствие SQL Azure.

1958531 Если соединение с сервером, который не настроен для зеркального отображения базы данных, отказывает в процессе входа
        (например, базы данных не существует), драйвер не выполняет повторной попытки автоматически.

1954701 Исключение, формируемое при вставке неуникальной строки, содержит SQLState 23000.

2055259 Расширенное сообщение об ошибке при неудачной встроенной проверке подлинности после загрузки sqljdbc_auth.dll.

2083373 Большие параметризованные запросы с недопустимыми аргументами к SQL Azure приведут к возникновению исключения без разрыва соединения.

2084385 getDate, getTimestamp, getDateTimeOffset возвращают правильные значения при использовании JRE 1.7 для всех дат.

2105115 Метод getObject для ResultSet, полученного из DatabaseMetaData.getColumns, работает корректно.


ИЗВЕСТНЫЕ ПРОБЛЕМЫ
------------
Далее представлены известные проблемы с драйвером Microsoft JDBC 4.0 для SQL Server.

1) ОГРАНИЧЕНИЯ ПАРАМЕТРОВ МЕТАДАННЫХ В ИНСТРУКЦИИ SQL MERGE

Метод PreparedStatement.getParameterMetadata() формирует исключение SQLException 
при использовании с параметризованным запросом MERGE.


2) JavaKerberos и виртуальные машины IBM

При выполнении в среде Windows, возможно, потребуется указать имя участника principalname в файле конфигурации для исправной работы Java Kerberos. Например: 
SQLJDBCDriver {
com.ibm.security.auth.module.Krb5LoginModule требовал useDefaultCcache=true credsType=initiator principal=principalname@principaldomain;
};


3) РАЗРЫВ СОЕДИНЕНИЯ ПРИ ИСПОЛЬЗОВАНИИ SQL AZURE

При установлении соединения с SQL Azure простаивающие соединения через определенное время бездействия могут 
быть разорваны сетевым компонентом (например, брандмауэром). Чтобы избежать разрыва связи простаивающих соединений сетевыми компонентами, 
необходимо задать следующие параметры в реестре операционной системе, в которой загружается драйвер
(или их аналоги для операционных систем, отличных от Windows):
           
           Параметр реестра                                                                 Рекомендуемое значение
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\KeepAliveTime                 30000      
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\KeepAliveInterval             1000
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\TcpMaxDataRetransmission      10
  



